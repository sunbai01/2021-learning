<!-- 小程序: 本质 && 协议 &&  客户端能力 -->

- 流量枯竭了，开发app，hybrid 不占优，小程序是闭源的框架

# 小程序特点

头条小程序很低调

- 小程序的本质更接近于hybrid开发

相当于给网页赋了很多API能力（用jsSDK（jsbridge）去调）
优良的离线性(不一定走网络，采用离线包的机制，保障了离线策略)

这两点比H5强，H5太弱了，要啥能力啥能力没有，尤其百度小程序有点弱，成熟度不够

- 扫二维码和蓝牙的能力

# 离线包原理

- 微信小程序实际上是存在于cdn上的zip包

# api调用原理

客户端开发过一些接口，关于oc和js通信，客户端实际上是可以拦截前端请求的

有很多人发非常多非http请求头的，如wx://xxx/camera, 碰到这样子的请求就吊起相应的小程序的摄像头，这是小程序的通信原理

小程序协议表明意图，这样形成了能力调用，客户端有在前端网页里执行函数（一般是执行api的回调）的能力，这样调用成功，这种循环就是我们所说的api

# 一个简单小程序的开发（是个程序的开发，不是一个页面的开发）

## 大致目录结构

有好几个页面的小程序有一个整体全局的配置 - app.json

app.js 常驻后台

sitemap是wx小程序爬取的规则，允许爬哪个页面

app.css 会被每个页面引

## 一个页面的开发（自定义组件、反射、怎么写视图，视图里的数据绑定）

类似于 vue 或者 react 这些框架，第一要素肯定是要有数据，一般写vue在js里定义data，template里直接用(key的作用：方便性能优化
)，小程序也是一样的js定义view用。
两者不一样的点在于vue中data定义的是一个function，小程序中是一个对象。

循环有类似于指令的关键字，需要写花括号

传递组件数据的方式，直接写props等于啥，例如data = {{data}}，子组件直接 data.title

# 进阶：底层原理 && 架构实现

微信客户端，小程序页面跳转比h5舒服点

每次微信初始化的时候，会创建一个web-view（chorom的一个tab）在上面，调navigatorTo的时候相当于web-view的覆盖，

如何做到app.js共享于baidu，taobao页面（两个页面互相改对方的对象）？

小程序框架：把两个web-view的js和app.js放在一个进程（一个web-view）里，俗称js-core，相当于把所有的js拿出来放在一个worker（service）里【这在编译时做】

setData 和 点击事件 通过消息传递给视图层，简称通讯，为什么setData不能频繁调，因为会往返于两个进程，拖慢速度（不停的双向通讯）

api就没碰过dom，querySelector这是个假api，为什么假呢，因为他是异步的，只是返回数据，碰不到dom

rpx 和 view 是怎么识别的？
view其实就是一个自定义组件，本质是 template 里有 span 和 slot ，区别在于 属性，这些高阶属性就是对外暴露的 props ,重建 web 生态系统，这是一个宏大的愿景

TODO：怎么把 js 放一起的呢？

技能图谱 && 学习曲线图




